{%- liquid
  assign section_st = section.settings
  assign section_width = section_st.section_width
  assign color_scheme = section_st.color_scheme
  assign reset_spacing = ''
  if section_st.reset_spacing
    assign reset_spacing = ' remove_spacing'
  endif
-%}

{%- capture style -%}
  --section-pt: {{ section_st.padding_top }}px; 
  --section-pb: {{ section_st.padding_bottom }}px;
  --speed: {{ section_st.speed }}s; 
  --image-width: {{ section_st.image_width }}px;
  --image-max-height: {{ section_st.image_max_height }}px;
  --col-gap: {{ section_st.space_between_images }}px;
  --text-align: {{ section_st.text_alignment }};
  --heading-size: {{ section_st.heading_size_custom }}px;
  --desc-size: {{ section_st.desc_size_custom }}px;
{%- endcapture -%}

<div
  class="section{% if section_st.padding_top < 30 %} pt-min{% endif %}{% if section_st.padding_bottom < 30 %} pb-min{% endif %} sec__scrolling-text color-{{ color_scheme }} gradient{{ reset_spacing }}"
  style="{{ style | strip | strip_newlines }}"
>
  <div class="{{ section_width }}">
    
    {%- if section_st.heading != blank or section_st.description != blank -%}
      <div class="marquee__header">
        {%- if section_st.heading != blank -%}
          <h2 class="marquee__heading" style="font-size: var(--heading-size);">
            {{ section_st.heading | escape }}
          </h2>
        {%- endif -%}
        {%- if section_st.description != blank -%}
          <div class="marquee__description rte" style="font-size: var(--desc-size);">
            {{ section_st.description }}
          </div>
        {%- endif -%}
      </div>
    {%- endif -%}

    <div class="marquee">
      {%- for i in (0..5) -%}
        <div class="animation-marquee {% if section_st.direction == 'right' %}reverse{% endif %}">
          {%- for block in section.blocks -%}
            {% assign block_st = block.settings %}
            <div class="marquee__item-image" {{ block.shopify_attributes }}>
              {%- if block_st.link != blank -%}<a href="{{ block_st.link }}" class="marquee__link">{%- endif -%}

              {%- if block_st.image != blank -%}
                {{ block_st.image | image_url: width: 800 | image_tag: loading: 'lazy', class: 'marquee-image', alt: block_st.image.alt }}
              {%- else -%}
                {{ 'image' | placeholder_svg_tag: 'placeholder-svg marquee-image' }}
              {%- endif -%}

              {%- if block_st.link != blank -%}</a>{%- endif -%}
            </div>
          {%- endfor -%}
        </div>
      {%- endfor -%}
    </div>
  </div>
</div>

<style>
  .sec__scrolling-text {
    padding-top: var(--section-pt);
    padding-bottom: var(--section-pb);
    overflow: hidden;
    width: 100%;
  }
  .marquee__header {
    text-align: var(--text-align);
    margin-bottom: 40px;
    padding: 0 20px;
  }
  .marquee__heading { 
    margin: 0 0 15px 0; 
    line-height: 1.2;
    font-weight: bold;
  }
  .marquee__description {
    max-width: 800px;
    margin: 0 auto;
    line-height: 1.5;
  }
  .marquee {
    display: flex;
    overflow: hidden;
    gap: var(--col-gap);
  }
  .animation-marquee {
    display: flex;
    flex-shrink: 0;
    align-items: center;
    gap: var(--col-gap);
    animation: scrolling-left var(--speed) linear infinite;
    padding-right: var(--col-gap);
  }
  .animation-marquee.reverse { animation-direction: reverse; }
  .marquee:hover .animation-marquee { animation-play-state: paused; }

  .marquee__item-image {
    flex-shrink: 0;
    width: var(--image-width);
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .marquee-image {
    width: 100%;
    height: auto;
    max-height: var(--image-max-height);
    object-fit: contain;
  }
  @keyframes scrolling-left {
    0% { transform: translateX(0); }
    100% { transform: translateX(-100%); }
  }
</style>

{% schema %}
{
  "name": "Logo Marquee Slider",
  "settings": [
    {
      "type": "select",
      "id": "section_width",
      "label": "Section width",
      "default": "full_width",
      "options": [
        { "value": "container", "label": "Container" },
        { "value": "full_width", "label": "Full width" }
      ]
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Text Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Nuestras Marcas"
    },
    {
      "type": "range",
      "id": "heading_size_custom",
      "label": "Heading Font Size",
      "default": 40, "min": 20, "max": 100, "step": 2, "unit": "px"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>Trabajamos con las mejores marcas del mercado.</p>"
    },
    {
      "type": "range",
      "id": "desc_size_custom",
      "label": "Description Font Size",
      "default": 18, "min": 12, "max": 40, "step": 1, "unit": "px"
    },
    {
      "type": "text_alignment",
      "id": "text_alignment",
      "label": "Text alignment",
      "default": "center"
    },
    {
      "type": "header",
      "content": "Marquee Settings"
    },
    {
      "type": "select",
      "id": "direction",
      "label": "Direction",
      "default": "left",
      "options": [{ "value": "left", "label": "Left" }, { "value": "right", "label": "Right" }]
    },
    {
      "type": "range",
      "id": "speed",
      "label": "Speed (Lower is faster)",
      "default": 20, "min": 5, "max": 100, "step": 1, "unit": "s"
    },
    {
      "type": "header",
      "content": "Image Configuration"
    },
    {
      "type": "range",
      "id": "image_width",
      "label": "Max Width of Image Container",
      "default": 200, "min": 50, "max": 500, "step": 10, "unit": "px"
    },
    {
      "type": "range",
      "id": "image_max_height",
      "label": "Max Height of Image",
      "default": 100, "min": 20, "max": 300, "step": 5, "unit": "px"
    },
    {
      "type": "range",
      "id": "space_between_images",
      "label": "Space between logos",
      "default": 60, "min": 0, "max": 200, "step": 5, "unit": "px"
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Top padding",
      "default": 40, "min": 0, "max": 100, "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Bottom padding",
      "default": 40, "min": 0, "max": 100, "unit": "px"
    }
  ],
  "blocks": [
    {
      "type": "logo",
      "name": "Image / Logo",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "url", "id": "link", "label": "Link" }
      ]
    }
  ],
  "presets": [{ "name": "Logo Marquee Slider", "blocks": [{ "type": "logo" }, { "type": "logo" }, { "type": "logo" }] }]
}
{% endschema %}